<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Lines</title>
    <link rel="stylesheet" href="css/style.css">
    <script type="text/javascript" src="js/paper-full.min.js"></script>
    <script type="text/paperscript" canvas="canvas">
        // Config Vars
        var spacing = 3;
        // tilt of the alternate lines
        var tilt = -25;
        var strokeWidth = .25;
        var strokeColor = "#333";
        var waveHeight = 20;
        var waveHeight2 = 25;
        // this number needs some work. It changes the speed but is unreliable (crazy math stuff)
        var animationSpeed = 10
        //number of points on each of the line sets
        var numPoints = 2;
        var numPointsAlt = 0;

        // Function for creating the lines.
        // Gets passed the Y Value, tilt (translated to pixels), and number of points
        function Line(y, t, p, h, w) {
            this.tilt = t;
            this.yLoc = y;
            this.numPoints = p;
            this.width = w;
            //this.theHeight = h;
            this.path = new Path();
            this.path.strokeColor = strokeColor;
            this.path.strokeWidth = strokeWidth;
            var step = this.width / (this.numPoints);

            //Add points to the line
            for (var j = 0; j <= this.numPoints; j++) {
                this.curveAmount = h;
                //Alternate the wave going up or down every other point
                if (j % 2 == 0){
                    this.curveAmount = h * -1;
                }
                this.path.add(new Point(j * step, this.yLoc - (tilt + 50) + (this.tilt / this.numPoints * (j+1)) + this.curveAmount));
            }
            //smooths the points
            this.path.smooth();
            // Add the line to the group
            group.addChild(this.path);
        }
        var lines = [];
        var group = new Group();
        //create lines
        function drawLines(event){
          console.log("erasing that SHIT")
          group.removeChildren();
          console.log("draw lines");
          var height = view.size.height * 1.5;
          var width = view.size.width;
          var numLines = height / spacing;
          //var lines = [];
          for (var i = 0; i < numLines; i++) {
              var yLoc = i * spacing;
              lines.push(new Line(yLoc, 0, numPoints, waveHeight, width));
          }
        }
        // The onFrame function is called up to 60 times a second, it does the animations
        function onFrame(event) {
          if (lines) {
            // Loop through the segments of the paths of the lines objects and move them up and down
            for (var t = 0; t < lines.length; t++) {
              var line = lines[t];
              //Loop throught points on the line
              for (var p = 0; p < line.path.segments.length; p++) {

                // A cylic value between -1 and 1. Crazy math I don't get, but tweaked them enough to look cool.
                var sinus = Math.sin(event.time + (p * animationSpeed));

                // Change the y position of the segment point:
                line.path.segments[p].point.y = line.yLoc + (sinus * waveHeight - 100);
              }
            }
          }
        }
        window.addEventListener("resize", drawLines);
        drawLines();

    </script>
</head>
<body>
  <div class="background">
      <canvas id="canvas" resize="true"></canvas>
  </div>

</body>
</html>
